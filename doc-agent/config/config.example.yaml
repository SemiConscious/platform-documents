# Platform Documentation Agent Configuration

llm:
  # Using AWS Bedrock for Claude API access
  provider: bedrock
  model: eu.anthropic.claude-opus-4-5-20251101-v1:0  # Claude Opus 4.5 via EU inference profile
  max_tokens: 4096
  temperature: 0.3

mcp:
  # Natterbox MCP server (SSE transport with built-in OAuth)
  url: "https://avatar.natterbox-dev03.net/mcp/sse"
  transport: sse
  timeout: 60
  
  # OAuth configuration (MCP server handles GitHub/Confluence/Jira auth)
  oauth:
    authorization_url: "https://avatar.natterbox-dev03.net/mcp/authorize"
    token_url: "https://avatar.natterbox-dev03.net/mcp/token"
    client_id: "doc-agent"
    scopes: []

# Authentication configuration
auth:
  # Token cache directory (default: ~/.doc-agent/tokens)
  # cache_dir: ~/.doc-agent/tokens
  
  # AWS SSO (for Bedrock API)
  aws:
    enabled: true
    profile: "sso-dev03-admin"  # AWS profile with SSO configured
    region: eu-west-1
    use_aws_vault: true  # Use aws-vault for credential management

sources:
  # GitHub is the authoritative source - code is truth
  github:
    priority: authoritative  # Gold standard for documentation
    trust_level: high        # Content is always current
    organizations:
      - redmatter      # Main Natterbox GitHub org
      - natterbox      # Additional Natterbox org
      - SemiConscious  # Related repos
    exclude_repos:
      - ".*-deprecated"
      - ".*-archive"
      - "internal-tools"
    # Patterns for code analysis (in addition to metadata)
    code_analysis:
      graphql_patterns:
        - "**/*.graphql"
        - "**/schema.graphql"
        - "**/schema/*.graphql"
        - "**/graphql/**/*.graphql"
      openapi_patterns:
        - "openapi*.json"
        - "openapi*.yaml"
        - "openapi*.yml"
        - "swagger*.json"
        - "swagger*.yaml"
        - "**/api-spec/**"
      route_patterns:
        - "**/routes/**/*.ts"
        - "**/routes/**/*.js"
        - "**/controllers/**/*.ts"
        - "**/handlers/**/*.go"
        - "**/api/**/*.py"
    include_patterns:
      - "README.md"
      - "docs/**/*.md"
      - "*.yaml"
      - "*.yml"
      - "package.json"
      - "requirements.txt"
      - "go.mod"
      - "Cargo.toml"
      - "pom.xml"
      
  # Docs360 - Natterbox's public documentation portal
  docs360:
    enabled: true
    priority: authoritative  # Official public documentation
    trust_level: high        # Customer-facing docs should be accurate
    categories: []           # Empty = all categories
    exclude_categories: []   # Categories to skip
      
  # Confluence is reference only - may be outdated
  confluence:
    enabled: true
    priority: reference      # Use as guide, not authoritative
    trust_level: low         # Content may be outdated
    disclaimer: "Note: This information is sourced from Confluence and may not reflect current implementation. Refer to source code for authoritative details."
    spaces:
      - A          # Architecture (actual key, not ARCH)
      - CO         # Platform Support and Engineering
      - OPs        # Operations (case sensitive!)
      - SRE        # SRE
    exclude_labels:
      - draft
      - deprecated
      
  # Jira disabled - not useful for architectural documentation
  jira:
    enabled: false  # Trouble tickets, not architecture
    # Kept for reference if needed later
    projects:
      - PLAT
      - VOICE
      - INT
      - INFRA

output:
  directory: ./docs
  format: markdown
  
agents:
  discovery:
    parallelism: 5
    repo_parallelism: 10  # Parallel repo analysis (Claude API calls)
    timeout: 300
  analysis:
    parallelism: 3
    timeout: 600
  generation:
    parallelism: 10
    timeout: 120
  quality:
    parallelism: 5
    timeout: 60

quality:
  min_completeness: 0.8
  require_review: false
  validate_links: true
  
logging:
  level: INFO
  file: ./logs/doc-agent.log
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
